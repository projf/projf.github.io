<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  lang="en-gb">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<title>Square Root in Verilog | Project F - FPGA Development</title>

<meta property='og:title' content='Square Root in Verilog - Project F - FPGA Development'>
<meta property='og:description' content='The square root is useful in many circumstances, including statistics, graphics, and signal processing. In this FPGA recipe, we&rsquo;re going to look at a simple digit-by-digit square root algorithm for integer and fixed-point numbers. There are lower-latency methods, but this one is simple, using only subtraction and bit shifts. You might also be interested in Division in Verilog.
Draft post. Errors and omissions expected.
Updated 2020-12-23. Feedback to @WillFlux is most welcome.'>
<meta property='og:url' content='https://projectf.io/posts/square-root-in-verilog/'>
<meta property='og:site_name' content='Project F - FPGA Development'>
<meta property='og:type' content='article'><meta property='og:image' content='https://projectf.io/img/posts/square-root-in-verilog/social-card.png'><meta property='article:published_time' content='2020-12-22T00:00:00Z'/><meta property='article:modified_time' content='2020-12-22T00:00:00Z'/><meta name='twitter:card' content='summary_large_image'><meta name='twitter:site' content='@WillFlux'><meta name='twitter:creator' content='@WillFlux'>


<link href="https://projectf.io/index.xml" rel="alternate" type="application/rss+xml" title="Project F - FPGA Development" />

<link rel="stylesheet" href="/css/style.css"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<link rel="canonical" href="https://projectf.io/posts/square-root-in-verilog/">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<meta name="referrer" content="no-referrer, same-origin">
</head>
<body>
<section class="section">
  <div class="container">
    <nav id="nav-main" class="nav">
      <div id="nav-name" class="nav-left">
        <a id="nav-anchor" class="nav-item" href="https://projectf.io">
          <h1 id="nav-heading" class="title is-4">Project F - FPGA Development</h1>
        </a>
      </div>
      <div class="nav-right">
        <nav id="nav-items" class="nav-item level is-mobile"><a class="level-item" aria-label="github" href='https://github.com/projf'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="twitter" href='https://twitter.com/WillFlux'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="youtube" href='https://youtube.com/channel/UCaT0lvfWo1GStbp0neg8weg'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"/>
    <polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="rss" href='/index.xml'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle>
    
  </svg></i>
            </span>
          </a></nav>
      </div>
    </nav>

    <nav class="nav">
      
      <div class="nav-left"><a class="nav-item" href="/about">
          <h2 class="title is-5">About</h2>
        </a><a class="nav-item" href="/sitemap">
          <h2 class="title is-5">Sitemap</h2>
        </a><a class="nav-item" href="/tags/cookbook">
          <h2 class="title is-5">Cookbook</h2>
        </a><a class="nav-item" href="/tags/explore">
          <h2 class="title is-5">Explore</h2>
        </a><a class="nav-item" href="/tags/tools">
          <h2 class="title is-5">Tools</h2>
        </a></div>
      

      
    </nav>

  </div>
  <script src="/js/navicon-shift.js"></script>
</section>
<section class="section">
  <div class="container">
    <div class="subtitle tags is-6 is-pulled-right">
      
      
<a class="subtitle is-6" href="/tags/cookbook/">#cookbook</a>



  
  | <a class="subtitle is-6" href="/tags/maths/">#maths</a>
  


      
    </div>
    <h2 class="subtitle is-6">22 December 2020</h2>
    <h1 class="title">Square Root in Verilog</h1>
    
    <div class="content">
      <p>The square root is useful in many circumstances, including statistics, graphics, and signal processing. In this <a href="/tags/cookbook">FPGA recipe</a>, we&rsquo;re going to look at a simple digit-by-digit square root algorithm for integer and <a href="/posts/fixed-point-numbers-in-verilog/">fixed-point numbers</a>. There are lower-latency methods, but this one is simple, using only subtraction and bit shifts. You might also be interested in <a href="/posts/division-in-verilog/">Division in Verilog</a>.</p>
<p><strong>Draft post. Errors and omissions expected.</strong></p>
<p><em>Updated 2020-12-23. Feedback to <a href="https://twitter.com/WillFlux">@WillFlux</a> is most welcome.</em></p>
<h2 id="getting-radical">Getting Radical</h2>
<p>The square root of a number is a second number that multiplied by itself produces the first number. If <code>b</code> is the square root of <code>a</code>, then the following are different ways of representing their relationship:</p>
<ul>
<li><code>b² = a</code></li>
<li><code>b = a</code><sup><code>1/2</code></sup></li>
<li><code>b = √a</code></li>
</ul>
<p>The square root is usually represented with the <strong><a href="https://en.wikipedia.org/wiki/Radical_symbol">radical sign</a></strong> <code>√</code>, as in the last example.</p>
<p>Let&rsquo;s look at a few concrete examples:</p>
<ul>
<li><code>√4 = 2</code></li>
<li><code>√100 = 10</code></li>
<li><code>√2 ≈ 1.41421</code></li>
<li><code>√3 ≈ 1.73205</code></li>
</ul>
<p>Most square roots are <a href="https://en.wikipedia.org/wiki/Irrational_number">irrational</a>, so we only get an approximate answer algorithmically. However, the good news is that our method will provide an exact solution if one exists.</p>
<p>We&rsquo;re only going to consider the positive root in this post, but there is also a negative root. For example, the square roots of <code>4</code> are <code>+2</code> and <code>-2</code>.</p>
<h2 id="triangles">Triangles</h2>
<p><a href="https://en.wikipedia.org/wiki/Pythagorean_theorem">Pythagoras&rsquo;s theorem</a> is a fundamental equation in geometry. For a right-angled triangle, the area of the square of the hypotenuse is equal to the sum of the areas of the squares on the other two sides.</p>
<p><img src="/img/posts/square-root-in-verilog/pythagorean-triangle.png" alt="Pythagorean Triangle"></p>
<p><code>a² + b² = c²</code></p>
<p>Finding <code>c</code> is a common problem in computer graphics, which means solving <code>√(a² + b²)</code>.</p>
<p>For 3D modelling, it&rsquo;s common to need the <a href="https://en.wikipedia.org/wiki/Fast_inverse_square_root">reciprocal</a> of <code>c</code>.</p>
<p><em>Diagram courtesy of <a href="https://commons.wikimedia.org/wiki/File:Pythagorean.svg">Wikipedia</a> under the Creative Commons <a href="https://creativecommons.org/licenses/by-sa/3.0/deed.en">Attribution-Share Alike licence</a>.</em></p>
<h2 id="the-long-route">The Long Route</h2>
<p>So far, so (probably) familiar. However, you&rsquo;re unlikely to have calculated square roots by hand. Superficially, square roots seem too hard to do manually, but the approach is almost the same as <a href="/posts/division-in-verilog/#long-division">long division</a>. I won&rsquo;t go into the mathematics here, but Wikipedia has a decent write up: <a href="https://en.wikipedia.org/wiki/Methods_of_computing_square_roots#Digit-by-digit_calculation">methods of computing square roots</a>. Instead, we&rsquo;ll take a simple example, then turn it into a Verilog algorithm.</p>
<h3 id="example-1111001">Example: √1111001</h3>
<p>The number we&rsquo;re finding the root of is known as the <strong>radicand</strong>.</p>
<p>For our example, the radicand is <code>1111001</code> (121 in decimal).</p>
<p>We split the radicand into pairs starting with the least significant: <code>01 11 10 01</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plaintext" data-lang="plaintext">     1  0  1  1     Our answer: one digit for each pair of digits in the radicand
    ———————————
   √01 11 10 01     Our radicand

    01              Bring down the most significant pair
  - 01              Subtract 01
    ——
    00              Our answer is NOT negative, so our first answer digit is 1

    00 11           Bring down the next pair of digits and append to previous result
  - 01 01           Append 01 to our existing answer, 1, and subtract it
    —————
    11 00           Our result is negative, so our second answer digit is 0
                    We discard the result because it&#39;s negative

    00 11 10        Keep the existing digits, 00 11, and append the next pair
  -    10 01        Append 01 to our existing answer, 10, and subtract it
    ————————
       01 01        Our answer is NOT negative, so our next answer digit is 1

       01 01 01     Bring down the next pair of digits and append to previous result
    -  01 01 01     Append 01 to our existing answer, 101, and subtract it
       ————————
             00     Our answer is NOT negative, so our next answer digit is 1
</code></pre></div><p>There are no more pairs of digits, and the result of our last step is 0, so our answer is exact:</p>
<p><code>√01111001 = 1011</code> or in decimal <code>√121 = 11</code>.</p>
<p>We&rsquo;ll look at what happens for irrational roots, such as √2, when we come to fixed-point numbers.</p>
<h2 id="algorithm-implementation">Algorithm Implementation</h2>
<p>To make our algorithm usable on an FPGA, we need to turn the steps into simple operations we can represent in Verilog. The main change is using shifts to select numbers to work on. We&rsquo;ll use four registers in our algorithm:</p>
<ul>
<li><strong>X</strong> - input radicand we want the square root of</li>
<li><strong>A</strong> - holds the current value we&rsquo;re working on</li>
<li><strong>T</strong> - result of sign test</li>
<li><strong>Q</strong> - answer (built up a digit at a time)</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plaintext" data-lang="plaintext">Input: X=01111001 (decimal 121)

Step  A         X         T         Q       Description
——————————————————————————————————————————————————————————————————————————————
      00000000  01111001  00000000  0000    Starting values.

1     00000001  11100100                    Left shift X by two places into A.
                          00000000          Set T = A - {Q,01}: 01 - 01.
                                    0000    Left shift Q.
      00000000                      0001    Is T≥0? Yes. Set A=T and Q[0]=1.

2     00000011  10010000                    Left shift X by two places into A.
                          11111100          Set T = A - {Q,01}: 11 - 101.
                                    0010    Left shift Q.
                                            Is T≥0? No. Move to next step.

3     00001110  01000000                    Left shift X by two places into A.
                          00000101          Set T = A - {Q,01}: 1110 - 1001
                                    0100    Left shift Q.
      00000101                      0101    Is T≥0? Yes. Set A=T and Q[0]=1.

4     00010101  00000000                    Left shift X by two places into A.
                          00000000          Set T = A - {Q,01}: 10101 - 10101.
                                    1010    Left shift Q.
      00000000                      1011    Is T≥0? Yes. Set A=T and Q[0]=1.
——————————————————————————————————————————————————————————————————————————————

Output: Q=1010 (decimal 11), R=0 (remainder taken from final A).
</code></pre></div><h2 id="verilog-module">Verilog Module</h2>
<p>Our Verilog design uses the above algorithm, but you can configure the width of the radicand. The width must be a multiple of two, for example, when working with seven binary digits, you must set the width to eight.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-verilog" data-lang="verilog"><span style="color:#75715e">// Project F: Square Root
</span><span style="color:#75715e">// (C)2020 Will Green, Open source hardware released under the MIT License
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">`default_nettype</span> none
<span style="color:#66d9ef">`timescale</span> <span style="color:#ae81ff">1</span>ns <span style="color:#f92672">/</span> <span style="color:#ae81ff">1</span>ps

<span style="color:#66d9ef">module</span> sqrt #(<span style="color:#66d9ef">parameter</span> WIDTH<span style="color:#f92672">=</span><span style="color:#ae81ff">8</span>)
    (
    <span style="color:#66d9ef">input</span> <span style="color:#66d9ef">wire</span> <span style="color:#66d9ef">logic</span> clk,
    <span style="color:#66d9ef">input</span> <span style="color:#66d9ef">wire</span> <span style="color:#66d9ef">logic</span> start,          <span style="color:#75715e">// start signal
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">input</span> <span style="color:#66d9ef">wire</span> <span style="color:#66d9ef">logic</span> [WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>] x,  <span style="color:#75715e">// radicand
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">output</span>     <span style="color:#66d9ef">logic</span> [WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>] q,  <span style="color:#75715e">// root
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">output</span>     <span style="color:#66d9ef">logic</span> [WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>] r,  <span style="color:#75715e">// remainder
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">output</span>     <span style="color:#66d9ef">logic</span> done            <span style="color:#75715e">// done signal
</span><span style="color:#75715e"></span>    );

    <span style="color:#66d9ef">localparam</span> ROOTW <span style="color:#f92672">=</span> WIDTH <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">1</span>;  <span style="color:#75715e">// root width is half radicand
</span><span style="color:#75715e"></span>
    <span style="color:#66d9ef">logic</span> [WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>] x1, x1_next;  <span style="color:#75715e">// copy of radicand
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">logic</span> [WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>] q1, q1_next;  <span style="color:#75715e">// intermediate root
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">logic</span> [WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>] ac, ac_next;  <span style="color:#75715e">// accumulator
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">logic</span> [WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>] test_res;     <span style="color:#75715e">// sign test result
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">logic</span> [$clog2(ROOTW<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>] i;  <span style="color:#75715e">// radicand bit counter
</span><span style="color:#75715e"></span>
    <span style="color:#66d9ef">always_comb</span> <span style="color:#66d9ef">begin</span>
        test_res <span style="color:#f92672">=</span> ac <span style="color:#f92672">-</span> {q1[WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>], <span style="color:#ae81ff">2</span><span style="color:#ae81ff">&#39;b01</span>};
        <span style="color:#66d9ef">if</span> (test_res[WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">begin</span>  <span style="color:#75715e">// test is zero or positive?
</span><span style="color:#75715e"></span>            {ac_next, x1_next} <span style="color:#f92672">=</span> {test_res[WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>], x1, <span style="color:#ae81ff">2</span><span style="color:#ae81ff">&#39;b0</span>};
            q1_next <span style="color:#f92672">=</span> {q1[WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>], <span style="color:#ae81ff">1</span><span style="color:#ae81ff">&#39;b1</span>};
        <span style="color:#66d9ef">end</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">begin</span>
            {ac_next, x1_next} <span style="color:#f92672">=</span> {ac[WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>], x1, <span style="color:#ae81ff">2</span><span style="color:#ae81ff">&#39;b0</span>};
            q1_next <span style="color:#f92672">=</span> q1 <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>;
        <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">end</span>

    <span style="color:#66d9ef">always_ff</span> @(<span style="color:#66d9ef">posedge</span> clk) <span style="color:#66d9ef">begin</span>
        <span style="color:#66d9ef">if</span> (start) <span style="color:#66d9ef">begin</span>
            done <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0</span>;
            i <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0</span>;
            {ac, x1} <span style="color:#f92672">&lt;=</span> {{WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>{<span style="color:#ae81ff">1</span><span style="color:#ae81ff">&#39;b0</span>}}, x, <span style="color:#ae81ff">2</span><span style="color:#ae81ff">&#39;b0</span>};
            q1 <span style="color:#f92672">&lt;=</span> {WIDTH{<span style="color:#ae81ff">1</span><span style="color:#ae81ff">&#39;b0</span>}};
        <span style="color:#66d9ef">end</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>done) <span style="color:#66d9ef">begin</span>
            <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">==</span> ROOTW<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#66d9ef">begin</span>  <span style="color:#75715e">// we&#39;re done
</span><span style="color:#75715e"></span>                done <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1</span>;
                q <span style="color:#f92672">&lt;=</span> q1_next;
                r <span style="color:#f92672">&lt;=</span> ac_next <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">2</span>;  <span style="color:#75715e">// undo final shift
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">end</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">begin</span>  <span style="color:#75715e">// next iteration
</span><span style="color:#75715e"></span>                i <span style="color:#f92672">&lt;=</span> i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
                x1 <span style="color:#f92672">&lt;=</span> x1_next;
                ac <span style="color:#f92672">&lt;=</span> ac_next;
                q1 <span style="color:#f92672">&lt;=</span> q1_next;
            <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">endmodule</span>
</code></pre></div><p>To use the module, set <code>WIDTH</code> to the correct number of bits and input <code>x</code> to the radicand. To begin the calculation set <code>start</code> high for one clock. The <code>done</code> signal indicates when the calculation is complete; then you can read the result out of <code>q</code> and <code>r</code>.</p>
<p>The Verilog itself is straightforward. The algorithm is in the <code>always_comb</code> block, though we start with the initial shift already in place. The <code>always_ff</code> block sets up the initial values, then runs the algorithm for the number of digits in the root.</p>
<h3 id="testing">Testing</h3>
<p>The following test bench exercises the module:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-verilog" data-lang="verilog"><span style="color:#75715e">// Project F: Square Root Test Bench
</span><span style="color:#75715e">// (C)2020 Will Green, Open source hardware released under the MIT License
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">`default_nettype</span> none
<span style="color:#66d9ef">`timescale</span> <span style="color:#ae81ff">1</span>ns <span style="color:#f92672">/</span> <span style="color:#ae81ff">1</span>ps

<span style="color:#66d9ef">module</span> sqrt_tb();

    <span style="color:#66d9ef">parameter</span> CLK_PERIOD <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>;
    <span style="color:#66d9ef">parameter</span> WIDTH <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>;

    <span style="color:#66d9ef">logic</span> clk;
    <span style="color:#66d9ef">logic</span> start;            <span style="color:#75715e">// start signal
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">logic</span> [WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>] x;    <span style="color:#75715e">// dividend
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">logic</span> [WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>] q;    <span style="color:#75715e">// quotient
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">logic</span> [WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>] r;    <span style="color:#75715e">// remainder
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">logic</span> done;             <span style="color:#75715e">// done signal
</span><span style="color:#75715e"></span>
    sqrt #(.WIDTH(WIDTH)) sqrt_inst (.<span style="color:#f92672">*</span>);

    <span style="color:#66d9ef">always</span> #(CLK_PERIOD <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>) clk <span style="color:#f92672">=</span> <span style="color:#f92672">~</span>clk;

    <span style="color:#66d9ef">initial</span> <span style="color:#66d9ef">begin</span>
                clk <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;

        #<span style="color:#ae81ff">100</span>    x <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span><span style="color:#ae81ff">&#39;b00000000</span>;  <span style="color:#75715e">// 0
</span><span style="color:#75715e"></span>                start <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
        #<span style="color:#ae81ff">10</span>     start <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
        #<span style="color:#ae81ff">40</span>     $display(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">%d:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">sqrt(%d) =%d (r =%d)&#34;</span>, $time, x, q, r);

                x <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span><span style="color:#ae81ff">&#39;b00000001</span>;  <span style="color:#75715e">// 1
</span><span style="color:#75715e"></span>                start <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
        #<span style="color:#ae81ff">10</span>     start <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
        #<span style="color:#ae81ff">40</span>     $display(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">%d:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">sqrt(%d) =%d (r =%d)&#34;</span>, $time, x, q, r);

                x <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span><span style="color:#ae81ff">&#39;b01111001</span>;  <span style="color:#75715e">// 121
</span><span style="color:#75715e"></span>                start <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
        #<span style="color:#ae81ff">10</span>     start <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
        #<span style="color:#ae81ff">40</span>     $display(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">%d:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">sqrt(%d) =%d (r =%d)&#34;</span>, $time, x, q, r);

                x <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span><span style="color:#ae81ff">&#39;b01010001</span>;  <span style="color:#75715e">// 81
</span><span style="color:#75715e"></span>                start <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
        #<span style="color:#ae81ff">10</span>     start <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
        #<span style="color:#ae81ff">40</span>     $display(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">%d:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">sqrt(%d) =%d (r =%d)&#34;</span>, $time, x, q, r);

                x <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span><span style="color:#ae81ff">&#39;b01011010</span>;  <span style="color:#75715e">// 90
</span><span style="color:#75715e"></span>                start <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
        #<span style="color:#ae81ff">10</span>     start <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
        #<span style="color:#ae81ff">40</span>     $display(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">%d:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">sqrt(%d) =%d (r =%d)&#34;</span>, $time, x, q, r);

                x <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span><span style="color:#ae81ff">&#39;b11111111</span>;  <span style="color:#75715e">// 255
</span><span style="color:#75715e"></span>                start <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
        #<span style="color:#ae81ff">10</span>     start <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
        #<span style="color:#ae81ff">40</span>     $display(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">%d:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">sqrt(%d) =%d (r =%d)&#34;</span>, $time, x, q, r);
                $finish;
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">endmodule</span>
</code></pre></div><h2 id="fixed-point-support">Fixed Point Support</h2>
<p>In a previous recipe, we looked at <a href="/posts/fixed-point-numbers-in-verilog/">Fixed Point Numbers in Verilog</a>&hellip;</p>
<p><em>This section is being written&hellip;</em></p>

      
      <div class="related">

<h3>Similar articles:</h3>
<ul>
	
	<li><a href="/posts/division-in-verilog/">Division in Verilog</a></li>
	
	<li><a href="/posts/fixed-point-numbers-in-verilog/">Fixed Point Numbers in Verilog</a></li>
	
	<li><a href="/posts/fpga-memory-types/">FPGA Memory Types</a></li>
	
	<li><a href="/posts/video-timings-vga-720p-1080p/">Video Timings: VGA, SVGA, 720p, 1080p</a></li>
	
	<li><a href="/posts/initialize-memory-in-verilog/">Initialize Memory in Verilog</a></li>
	
</ul>
</div>
      
    </div>
    
  </div>
</section>

    <script src="/js/copycode.js"></script>



<section class="section">
  <div class="container has-text-centered">
    <p>©2020 Will Green, Project F</p>
    
  </div>
</section>


<script src="https://narwhal.projectf.io/script.js" site="EVCGKVDN" defer></script>
</body>
</html>

